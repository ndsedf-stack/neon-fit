<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>HYBRID 63 // OPS</title>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700;800&family=Inter:wght@400;500;600;800&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

  <style>
    :root {
      --cyan: #22d3ee;
      --cyan-dim: rgba(34, 211, 238, 0.1);
      --dark-bg: #020617;
      --card-bg: #0f172a;
    }

    body {
      background-color: var(--dark-bg);
      font-family: 'Inter', sans-serif;
      color: #e2e8f0;
      /* Smooth scroll & safe areas */
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);
      overflow-x: hidden;
      -webkit-tap-highlight-color: transparent;
    }

    /* --- CANVAS BACKGROUND --- */
    #neuro-net {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        z-index: -2;
        background: radial-gradient(circle at 50% 30%, #172554 0%, #020617 70%);
    }

    /* --- TYPOGRAPHY --- */
    .font-hud { font-family: 'Rajdhani', sans-serif; }
    .font-mono-tech { font-family: 'Share Tech Mono', monospace; }
    .text-glow { text-shadow: 0 0 12px rgba(34, 211, 238, 0.5); }

    /* --- 3D TIMELINE --- */
    .timeline-container {
        display: flex;
        overflow-x: auto;
        scroll-snap-type: x mandatory;
        padding: 20px 50% 20px 20px; /* Center alignment padding */
        gap: 12px;
        scrollbar-width: none;
        mask-image: linear-gradient(90deg, transparent, black 10%, black 90%, transparent);
        -webkit-mask-image: linear-gradient(90deg, transparent, black 10%, black 90%, transparent);
    }
    .timeline-container::-webkit-scrollbar { display: none; }

    .week-chip {
        scroll-snap-align: center;
        flex: 0 0 64px;
        height: 80px;
        background: rgba(30, 41, 59, 0.4);
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 16px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        backdrop-filter: blur(5px);
    }

    .week-chip.active {
        background: rgba(34, 211, 238, 0.1);
        border-color: var(--cyan);
        transform: scale(1.15);
        box-shadow: 0 0 20px rgba(34, 211, 238, 0.2);
        z-index: 10;
        color: white;
    }
    
    .week-chip.deload { border-color: #f59e0b; }
    .week-chip.deload.active { background: rgba(245, 158, 11, 0.1); box-shadow: 0 0 20px rgba(245, 158, 11, 0.2); }

    /* --- MISSION CARD --- */
    .mission-card {
        background: rgba(15, 23, 42, 0.7);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 20px;
        overflow: hidden;
        position: relative;
        transition: transform 0.2s;
    }
    .mission-card:active { transform: scale(0.98); }
    
    /* Decoration Line */
    .mission-card::before {
        content: '';
        position: absolute;
        left: 0; top: 0; bottom: 0; width: 4px;
        background: var(--cyan);
        opacity: 0.5;
    }

    /* --- BOTTOM NAV --- */
    .nav-dock {
        position: fixed;
        bottom: 24px;
        left: 50%;
        transform: translateX(-50%);
        width: 90%;
        max-width: 400px;
        height: 70px;
        background: rgba(15, 23, 42, 0.85);
        backdrop-filter: blur(25px);
        border: 1px solid rgba(255,255,255,0.15);
        border-radius: 24px;
        display: flex;
        justify-content: space-around;
        align-items: center;
        z-index: 50;
        box-shadow: 0 10px 40px rgba(0,0,0,0.5);
    }
    
    .nav-item {
        color: #64748b;
        transition: all 0.3s;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
    }
    .nav-item.active { color: var(--cyan); transform: translateY(-2px); }
    .nav-item.active svg { filter: drop-shadow(0 0 8px var(--cyan)); }

  </style>
</head>
<body class="antialiased">

  <canvas id="neuro-net"></canvas>

  <!-- HEADER -->
  <header class="fixed top-0 w-full z-40 bg-[#020617]/90 backdrop-blur-md border-b border-white/5 pt-safe">
      <div class="flex justify-between items-center px-6 h-16">
          <div>
              <div class="flex items-center gap-1.5 mb-0.5">
                   <div class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></div>
                   <span class="text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em] font-mono-tech">COMMAND CENTER</span>
              </div>
              <h1 class="text-xl font-hud font-black text-white italic tracking-wide">
                  TRAINING_OPS
              </h1>
          </div>
          
          <button onclick="window.location.href='index.html'" class="w-10 h-10 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center text-slate-400 active:bg-white/10">
              <i data-lucide="home" class="w-5 h-5"></i>
          </button>
      </div>
      
      <!-- TIMELINE -->
      <div class="timeline-container pb-4 pt-2" id="timeline">
          <!-- JS Generated -->
      </div>
  </header>

  <!-- CONTENT -->
  <main class="relative z-10 pt-[160px] pb-32 px-5 space-y-5">
      
      <!-- INTEL PANEL -->
      <section class="relative rounded-2xl bg-gradient-to-r from-blue-900/20 to-slate-900/20 border border-white/10 p-5 overflow-hidden">
          <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-5 mix-blend-overlay"></div>
          
          <div class="relative z-10">
              <div class="flex justify-between items-start mb-4">
                  <div>
                      <div class="text-[9px] text-cyan-500 font-bold uppercase tracking-widest mb-1">Active Protocol</div>
                      <h2 class="text-2xl font-hud font-black text-white uppercase text-glow leading-none" id="block-title">LOADING</h2>
                  </div>
                  <div class="text-right">
                      <div class="text-[9px] text-slate-400 font-bold uppercase tracking-widest mb-1">RPE Target</div>
                      <div class="text-2xl font-mono-tech font-bold text-yellow-400" id="rpe-val">--</div>
                  </div>
              </div>
              
              <div class="flex items-center gap-3 bg-black/30 p-2 rounded-lg border border-white/5">
                  <div class="p-1.5 bg-cyan-500/10 rounded">
                      <i data-lucide="zap" class="w-4 h-4 text-cyan-400"></i>
                  </div>
                  <div>
                      <div class="text-[8px] text-slate-500 uppercase font-bold">Technique</div>
                      <div class="text-xs font-bold text-white uppercase" id="tech-val">---</div>
                  </div>
              </div>
          </div>
      </section>

      <!-- WORKOUTS LIST -->
      <div id="workouts-list" class="space-y-4">
          <!-- JS Injected -->
      </div>

  </main>

  <!-- DOCK -->
  <nav class="nav-dock">
      <button class="nav-item active">
          <i data-lucide="crosshair" class="w-6 h-6"></i>
      </button>
      <button class="nav-item">
          <i data-lucide="bar-chart-2" class="w-6 h-6"></i>
      </button>
      <div class="w-px h-8 bg-white/10"></div>
      <button class="nav-item">
          <i data-lucide="calendar" class="w-6 h-6"></i>
      </button>
      <button class="nav-item">
          <i data-lucide="user" class="w-6 h-6"></i>
      </button>
  </nav>

  <script type="module">
    import programData from './program-data.js';

    // --- CANVAS ---
    const canvas = document.getElementById('neuro-net');
    const ctx = canvas.getContext('2d');
    let w, h;
    function resize() { w=canvas.width=window.innerWidth; h=canvas.height=window.innerHeight; }
    window.addEventListener('resize', resize); resize();
    
    // Simple Particles
    const parts = Array(30).fill().map(()=>({
        x: Math.random()*w, y: Math.random()*h, 
        vx: (Math.random()-0.5)*0.2, vy: (Math.random()-0.5)*0.2,
        s: Math.random()*2
    }));
    function anim() {
        ctx.clearRect(0,0,w,h);
        ctx.fillStyle='rgba(255,255,255,0.05)';
        parts.forEach(p=>{
            p.x+=p.vx; p.y+=p.vy;
            if(p.x<0||p.x>w) p.vx*=-1; if(p.y<0||p.y>h) p.vy*=-1;
            ctx.beginPath(); ctx.arc(p.x,p.y,p.s,0,Math.PI*2); ctx.fill();
        });
        requestAnimationFrame(anim);
    }
    anim();

    // --- LOGIC ---
    let currentWeek = 1;

    // GLOBAL FUNCTIONS FOR HTML BUTTONS
    window.selectWeek = (wk) => {
        currentWeek = wk;
        renderTimeline();
        renderView();
    };

    window.goToSession = (wk, day) => {
        // Direct link with parameters
        window.location.href = `session.html?week=${wk}&day=${day}`;
    };

    function init() {
        renderTimeline();
        renderView();
        lucide.createIcons();
    }

    function renderTimeline() {
        const cont = document.getElementById('timeline');
        cont.innerHTML = '';
        
        for(let i=1; i<=26; i++) {
            const isDeload = programData.isDeloadWeek(i);
            const el = document.createElement('button');
            el.className = `week-chip ${i===currentWeek ? 'active' : ''} ${isDeload ? 'deload' : ''}`;
            el.onclick = () => window.selectWeek(i);
            el.innerHTML = `
                <span class="text-[9px] font-bold uppercase ${isDeload?'text-orange-400':'text-slate-500'}">WK</span>
                <span class="text-2xl font-hud font-bold ${isDeload?'text-orange-100':'text-white'}">${i}</span>
            `;
            cont.appendChild(el);
            
            // Auto scroll to active
            if(i === currentWeek) {
                setTimeout(() => el.scrollIntoView({ behavior:'smooth', inline:'center' }), 100);
            }
        }
    }

    function renderView() {
        const weekData = programData.getWeek(currentWeek);
        const blockName = programData.info.blockTechniques[`block${weekData.block}`]?.name || 'Unknown';
        
        document.getElementById('block-title').textContent = blockName;
        document.getElementById('rpe-val').textContent = weekData.rpeTarget;
        document.getElementById('tech-val').textContent = weekData.technique;

        const list = document.getElementById('workouts-list');
        list.innerHTML = '';

        const days = ['dimanche', 'mardi', 'vendredi', 'maison'];
        const meta = {
            'dimanche': { l: 'FULL BODY', c: 'cyan', icon: 'dumbbell' },
            'mardi': { l: 'UPPER BODY', c: 'violet', icon: 'layers' },
            'vendredi': { l: 'HYBRID', c: 'emerald', icon: 'zap' },
            'maison': { l: 'HOME', c: 'amber', icon: 'home' }
        };

        days.forEach(day => {
            const wo = weekData[day];
            if(!wo) return;
            const m = meta[day];
            
            const card = document.createElement('div');
            card.className = "mission-card p-5 group";
            card.onclick = () => window.goToSession(currentWeek, day);
            
            card.innerHTML = `
                <div class="flex justify-between items-start mb-4">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 rounded-xl bg-${m.c}-500/10 border border-${m.c}-500/30 flex items-center justify-center text-${m.c}-400">
                            <i data-lucide="${m.icon}" class="w-6 h-6"></i>
                        </div>
                        <div>
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-[9px] font-bold text-slate-400 bg-white/5 px-1.5 py-0.5 rounded border border-white/10 uppercase">${m.l}</span>
                                <span class="text-[9px] font-mono-tech text-slate-500">${wo.duration} MIN</span>
                            </div>
                            <h3 class="text-lg font-hud font-bold text-white uppercase leading-tight max-w-[180px]">${wo.name.split('+')[0]}</h3>
                        </div>
                    </div>
                    <div class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center group-active:bg-${m.c}-500 group-active:text-black transition-colors">
                        <i data-lucide="chevron-right" class="w-4 h-4 text-slate-400 group-active:text-black"></i>
                    </div>
                </div>
                
                <div class="pl-[64px] space-y-2">
                    <div class="h-px w-full bg-white/5"></div>
                    <div class="flex justify-between items-center text-xs">
                         <div class="text-slate-400 font-mono-tech"><span class="text-white font-bold">${wo.totalSets}</span> SETS</div>
                         <div class="text-slate-400 font-mono-tech"><span class="text-${m.c}-400 font-bold">${wo.exercises.length}</span> EXERCISES</div>
                    </div>
                </div>
            `;
            list.appendChild(card);
        });
        
        lucide.createIcons();
    }

    // Init
    init();

  </script>
</body>
</html>
