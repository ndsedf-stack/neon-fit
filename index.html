<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>NEON FIT // TACTICAL DASHBOARD</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700;800&family=Inter:wght@400;500;600;800&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

  <style>
    :root {
      --cyan: #00eaff;
      --magenta: #ff2d95;
      --dark-bg: #050510;
    }
    body {
      background-color: var(--dark-bg);
      font-family: 'Inter', sans-serif;
      color: white;
      padding-bottom: env(safe-area-inset-bottom);
      overflow-x: hidden;
      -webkit-tap-highlight-color: transparent;
    }
    .font-hud { font-family: 'Rajdhani', sans-serif; }
    .font-mono-tech { font-family: 'Share Tech Mono', monospace; }
    
    /* Neon Glows */
    .glow-text-cyan { text-shadow: 0 0 10px rgba(0, 234, 255, 0.6); }
    .glow-text-magenta { text-shadow: 0 0 10px rgba(255, 45, 149, 0.6); }
    .glow-box { box-shadow: 0 0 20px rgba(0, 234, 255, 0.15); }

    /* XP Bar Animation */
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    .xp-fill {
      background: linear-gradient(90deg, var(--cyan), #fff, var(--cyan));
      background-size: 200% 100%;
      animation: shimmer 3s infinite linear;
    }

    /* Canvas Background */
    #matrix-bg {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
        background: radial-gradient(circle at 50% 50%, #1a1a2e 0%, #050510 100%);
    }

    /* Horizontal Scroll Snap */
    .snap-x-mandatory {
        scroll-snap-type: x mandatory;
    }
    .snap-center {
        scroll-snap-align: center;
    }
  </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.554.0"
  }
}
</script>
</head>
<body class="antialiased">

  <canvas id="matrix-bg"></canvas>

  <!-- GAMIFICATION HEADER -->
  <div class="fixed top-0 w-full z-50 bg-[#050510]/90 backdrop-blur-md border-b border-white/10 pt-safe px-4 pb-2">
      <div class="flex justify-between items-end mb-1">
          <div class="flex flex-col">
              <span class="text-[9px] font-bold text-slate-400 uppercase tracking-widest">Rang Opérateur</span>
              <span class="text-sm font-hud font-bold text-white uppercase" id="user-rank">RECRUE</span>
          </div>
          <div class="text-right">
               <span class="text-xs font-mono-tech text-cyan-400" id="xp-display">0 / 1000 XP</span>
          </div>
      </div>
      <!-- XP Bar -->
      <div class="h-1.5 w-full bg-slate-800 rounded-full overflow-hidden relative">
          <div class="h-full xp-fill absolute top-0 left-0" id="xp-bar" style="width: 0%"></div>
      </div>
  </div>

  <main class="relative z-10 pt-[80px] pb-28 px-4 space-y-6">

      <!-- HERO SECTION -->
      <section class="mt-4 mb-2 text-center">
          <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10 mb-3">
              <span class="relative flex h-2 w-2">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-magenta-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-2 w-2 bg-[var(--magenta)]"></span>
              </span>
              <span class="text-[10px] font-bold uppercase tracking-widest text-slate-300">Système V2.0 En Ligne</span>
          </div>
          <h1 class="text-4xl font-hud font-black text-white italic leading-none mb-1">
              PASSEZ AU <br> <span class="text-transparent bg-clip-text bg-gradient-to-r from-[var(--cyan)] to-[var(--magenta)] glow-text-cyan">NIVEAU SUPÉRIEUR</span>
          </h1>
          <p class="text-xs text-slate-400 max-w-[250px] mx-auto">Accomplissez les missions. Gagnez de l'XP. Devenez une Élite.</p>
      </section>

      <!-- DASHBOARD GRID -->
      <div class="grid grid-cols-2 gap-3">
          <!-- Current Streak -->
          <div class="bg-white/5 border border-white/10 rounded-2xl p-4 flex flex-col items-center justify-center glow-box backdrop-blur-sm">
              <i data-lucide="flame" class="w-6 h-6 text-orange-500 mb-2"></i>
              <div class="text-2xl font-mono-tech font-bold text-white">3</div>
              <div class="text-[9px] uppercase font-bold text-slate-500">Série Jours</div>
          </div>
          <!-- Level -->
          <div class="bg-white/5 border border-white/10 rounded-2xl p-4 flex flex-col items-center justify-center glow-box backdrop-blur-sm">
              <i data-lucide="award" class="w-6 h-6 text-[var(--cyan)] mb-2"></i>
              <div class="text-2xl font-mono-tech font-bold text-white" id="level-display">1</div>
              <div class="text-[9px] uppercase font-bold text-slate-500">Niveau Actuel</div>
          </div>
      </div>

      <!-- WORKOUTS CAROUSEL -->
      <section>
          <div class="flex items-center justify-between mb-3 px-1">
              <h2 class="text-sm font-bold text-white uppercase tracking-widest flex items-center gap-2">
                  <i data-lucide="crosshair" class="w-4 h-4 text-[var(--cyan)]"></i>
                  MISSIONS SEMAINE <span id="week-num">01</span>
              </h2>
          </div>
          
          <!-- Horizontal Scroll Container -->
          <div class="flex overflow-x-auto snap-x-mandatory gap-4 pb-4 -mx-4 px-4 scrollbar-hide" id="workout-carousel">
              <!-- Cards Injected by JS -->
          </div>
      </section>

      <!-- STORYTELLING QUOTE -->
      <div class="p-6 relative rounded-xl border border-white/5 bg-gradient-to-r from-white/5 to-transparent backdrop-blur-md overflow-hidden">
          <div class="absolute -right-4 -top-4 opacity-10"><i data-lucide="quote" class="w-24 h-24 text-white"></i></div>
          <p class="relative z-10 font-hud text-lg italic text-slate-200 leading-tight">
              "On n'obtient pas ce que l'on souhaite. On obtient ce pour quoi on <span class="text-[var(--cyan)] font-bold">travaille</span>."
          </p>
      </div>

  </main>

  <!-- BOTTOM NAV COCKPIT -->
  <nav class="fixed bottom-4 left-4 right-4 h-16 bg-[#0f0f20]/90 backdrop-blur-xl border border-white/10 rounded-2xl flex justify-around items-center z-50 shadow-2xl">
      <button class="flex flex-col items-center gap-1 w-12 text-[var(--cyan)]">
          <i data-lucide="layout-grid" class="w-6 h-6 drop-shadow-[0_0_5px_rgba(0,234,255,0.8)]"></i>
          <span class="text-[8px] font-bold uppercase">QG</span>
      </button>
      <button onclick="window.location.href='workouts.html'" class="flex flex-col items-center gap-1 w-12 text-slate-500 hover:text-white transition-colors">
          <i data-lucide="target" class="w-6 h-6"></i>
          <span class="text-[8px] font-bold uppercase">Ops</span>
      </button>
      
      <!-- FAB -->
      <div class="relative -top-6">
          <button onclick="window.location.href='workouts.html'" class="w-14 h-14 rounded-full bg-gradient-to-tr from-[var(--magenta)] to-purple-600 flex items-center justify-center shadow-[0_0_20px_rgba(255,45,149,0.6)] border-2 border-[#050510] transition-transform active:scale-95">
              <i data-lucide="zap" class="w-7 h-7 text-white fill-white"></i>
          </button>
      </div>

      <button onclick="alert('Bientôt disponible')" class="flex flex-col items-center gap-1 w-12 text-slate-500 hover:text-white transition-colors">
          <i data-lucide="bar-chart-2" class="w-6 h-6"></i>
          <span class="text-[8px] font-bold uppercase">Données</span>
      </button>
      <button onclick="alert('Bientôt disponible')" class="flex flex-col items-center gap-1 w-12 text-slate-500 hover:text-white transition-colors">
          <i data-lucide="user-circle" class="w-6 h-6"></i>
          <span class="text-[8px] font-bold uppercase">Profil</span>
      </button>
  </nav>

  <script type="module">
    import programData from './program-data.js';

    // --- GAMIFICATION LOGIC ---
    const XP_LEVELS = [0, 1000, 2500, 5000, 10000];
    const RANKS = ["Recrue", "Soldat", "Vétéran", "Élite", "Légende"];
    
    function loadGamification() {
        const xp = parseInt(localStorage.getItem('hybrid_xp') || '0');
        let level = 1;
        let nextXp = XP_LEVELS[1];
        
        for(let i=0; i<XP_LEVELS.length; i++) {
            if(xp >= XP_LEVELS[i]) {
                level = i + 1;
                nextXp = XP_LEVELS[i+1] || 99999;
            }
        }
        
        const rank = RANKS[Math.min(level-1, RANKS.length-1)];
        const progress = Math.min(100, (xp / nextXp) * 100);

        document.getElementById('user-rank').textContent = `${rank} IV`;
        document.getElementById('level-display').textContent = level;
        document.getElementById('xp-display').textContent = `${xp} / ${nextXp} XP`;
        document.getElementById('xp-bar').style.width = `${progress}%`;
    }

    // --- CAROUSEL LOGIC ---
    function initDashboard() {
        lucide.createIcons();
        loadGamification();
        
        const currentWeek = parseInt(localStorage.getItem('hybrid_current_week') || 1);
        document.getElementById('week-num').textContent = String(currentWeek).padStart(2, '0');
        
        const container = document.getElementById('workout-carousel');
        const days = ['dimanche', 'mardi', 'vendredi', 'maison'];
        const weekData = programData.getWeek(currentWeek);

        days.forEach(day => {
            const workout = weekData[day];
            if(!workout) return;

            // Calculate Volume
            let vol = 0;
            workout.exercises.forEach(ex => {
                const r = typeof ex.reps === 'string' ? 8 : ex.reps;
                vol += ex.sets * r * ex.weight;
            });

            // Card HTML
            const card = document.createElement('div');
            card.className = "snap-center shrink-0 w-[85%] relative group cursor-pointer mission-card";
            card.onclick = () => window.location.href = `session.html?week=${currentWeek}&day=${day}`;
            
            card.innerHTML = `
              <div class="absolute -inset-0.5 bg-gradient-to-r from-[var(--cyan)] to-[var(--magenta)] rounded-2xl opacity-75 blur group-hover:opacity-100 transition duration-1000 group-hover:duration-200"></div>
              <div class="relative bg-[#0a0a1a] rounded-xl p-0 overflow-hidden border border-white/10 h-full flex flex-col">
                  
                  <!-- Hero Image -->
                  <div class="h-32 relative shrink-0">
                      <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1534438327276-14e5300c3a48?q=80&w=1470&auto=format&fit=crop')] bg-cover bg-center opacity-60"></div>
                      <div class="absolute inset-0 bg-gradient-to-t from-[#0a0a1a] via-[#0a0a1a]/50 to-transparent"></div>
                      
                      <div class="absolute bottom-3 left-4 right-4 flex justify-between items-end">
                          <div>
                              <div class="flex items-center gap-2 mb-1">
                                  <span class="px-2 py-0.5 rounded bg-[var(--cyan)]/10 border border-[var(--cyan)]/30 text-[9px] font-bold text-[var(--cyan)] uppercase">${day.toUpperCase()}</span>
                              </div>
                              <h3 class="text-xl font-hud font-black text-white leading-none italic uppercase truncate max-w-[200px]">${workout.name.split('+')[0]}</h3>
                          </div>
                          <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center shadow-[0_0_15px_white]">
                              <i data-lucide="play" class="w-5 h-5 text-black fill-current ml-1"></i>
                          </div>
                      </div>
                  </div>

                  <!-- Data Footer -->
                  <div class="grid grid-cols-3 divide-x divide-white/5 border-t border-white/5 bg-white/5 grow">
                      <div class="p-3 text-center flex flex-col justify-center">
                          <div class="text-[8px] uppercase text-slate-500 font-bold">Durée</div>
                          <div class="text-sm font-bold text-white">${workout.duration} min</div>
                      </div>
                      <div class="p-3 text-center flex flex-col justify-center">
                          <div class="text-[8px] uppercase text-slate-500 font-bold">Volume</div>
                          <div class="text-sm font-bold text-white">${(vol/1000).toFixed(1)}t</div>
                      </div>
                      <div class="p-3 text-center flex flex-col justify-center">
                          <div class="text-[8px] uppercase text-slate-500 font-bold">XP</div>
                          <div class="text-sm font-bold text-[var(--magenta)] glow-text-magenta">+500</div>
                      </div>
                  </div>
              </div>
            `;
            container.appendChild(card);
        });
        
        lucide.createIcons();
    }

    // --- CANVAS ---
    const canvas = document.getElementById('matrix-bg');
    const ctx = canvas.getContext('2d');
    let w, h;
    function resize() { w=canvas.width=window.innerWidth; h=canvas.height=window.innerHeight; }
    window.addEventListener('resize', resize); resize();
    
    const particles = Array(40).fill().map(() => ({
        x: Math.random()*w, y: Math.random()*h, 
        s: Math.random()*2, a: Math.random() 
    }));
    
    function anim() {
        ctx.clearRect(0,0,w,h);
        ctx.fillStyle = '#00eaff';
        particles.forEach(p => {
            p.y -= p.s * 0.2;
            if(p.y < 0) p.y = h;
            ctx.globalAlpha = p.a * 0.2;
            ctx.beginPath(); ctx.arc(p.x, p.y, p.s, 0, Math.PI*2); ctx.fill();
        });
        requestAnimationFrame(anim);
    }
    anim();

    initDashboard();
  </script>
</body>
</html>
